<!DOCTYPE html>
<html lang="pt-br" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Admin - PlayU</title>
    <script src="assets/js/version.79ce2603.js"></script>
    <script>
        function loadAsset(path) {
            const version = typeof SITE_VERSION !== 'undefined' ? SITE_VERSION : new Date().getTime();
            const extension = path.split('.').pop();
            if (extension === 'css') {
                document.write(`<link rel="stylesheet" href="${path}?v=${version}">`);
            } else if (extension === 'js') {
                document.write(`<script src="${path}?v=${version}" defer><\/script>`);
            }
        }
    </script>
</head>
<body>
    <header class="main-header">
        <div class="header-container">
            <h1 class="logo">Painel Admin</h1>
            <div class="user-menu">
                <span id="user-greeting">Olá, Admin</span>
                <a href="index.html" class="submit-btn small-btn">Voltar para Início</a>
            </div>
        </div>
        
        <div class="container dashboard-tabs" style="margin-top: 1rem; border-bottom: none;">
            <button class="tab-btn" onclick="switchAdminTab('user-management')">Usuários</button>
            <button class="tab-btn active" onclick="switchAdminTab('game-management')">Jogos</button>
            <button class="tab-btn" onclick="switchAdminTab('content-management')">Conteúdo</button>
            <button class="tab-btn" onclick="switchAdminTab('course-management')">Cursos</button>
        </div>
    </header>

    <main class="dashboard-main">
        
        <section id="user-management" class="dashboard-section hidden-section">
            <div class="section-header">
                <h2>Gerenciamento de Usuários</h2>
                <div class="search-box">
                    <ion-icon name="search-outline"></ion-icon>
                    <input type="text" id="user-search-input" placeholder="Buscar...">
                </div>
            </div>
            <div class="table-container">
                <table class="admin-table">
                    <thead><tr><th>Nome</th><th>Email</th><th>Cargo</th><th>Ações</th></tr></thead>
                    <tbody id="user-table-body"><tr><td colspan="4"><div class="loader"></div></td></tr></tbody>
                </table>
            </div>
        </section>

        <section id="game-management" class="dashboard-section">
            <div class="section-header">
                <h2>Gerenciamento de Jogos</h2>
                <button id="open-create-game-modal-btn" class="submit-btn"><ion-icon name="add-circle-outline"></ion-icon> Novo Jogo</button>
            </div>
            <div id="game-list-container" class="games-grid"></div>
        </section>

        <section id="content-management" class="dashboard-section hidden-section">
            <div class="section-header">
                <h2>Gerenciamento de Conteúdo</h2>
                <div class="content-tabs">
                    <button class="tab-btn active" data-target="edit-faq">FAQ</button>
                    <button class="tab-btn" data-target="edit-about">Sobre</button>
                </div>
            </div>
            <div id="edit-faq" class="content-sub-section active-section">
                <div id="faq-list-admin" class="bookings-list"></div>
                <button id="add-faq-btn" class="submit-btn" style="margin-top: 1rem;">Nova Pergunta</button>
            </div>
            <div id="edit-about" class="content-sub-section hidden-section">
                <form id="about-form">
                    <div class="form-group"><label>História</label><textarea id="about-history" rows="10"></textarea></div>
                    <button type="submit" class="submit-btn">Salvar</button>
                </form>
            </div>
        </section>

        <section id="course-management" class="dashboard-section hidden-section">
            <div class="section-header">
                <h2>Cursos Online</h2>
                <button id="add-course-btn" class="submit-btn"><ion-icon name="school-outline"></ion-icon> Criar Curso</button>
            </div>
            <div id="course-list-admin" class="game-grid"></div>
        </section>

    </main>

    <div id="edit-user-modal" class="modal-overlay hidden"><div class="modal-content"><button id="close-user-modal" class="close-overlay-btn">&times;</button><h3>Editar Usuário</h3><form id="edit-user-form"><input type="hidden" id="edit-user-id"><div class="form-group"><label>Nome</label><input type="text" id="edit-user-name" required></div><div class="form-group"><label>Cargo</label><select id="edit-user-role" class="role-select" style="width:100%"><option value="user">Jogador</option><option value="host">Host</option><option value="admin">Admin</option></select></div><div class="modal-footer"><button type="button" id="delete-user-btn" class="submit-btn danger-btn">Excluir</button><div class="right-buttons"><button type="button" id="cancel-edit-btn" class="submit-btn secondary-btn">Cancelar</button><button type="submit" class="submit-btn primary-btn">Salvar</button></div></div></form></div></div>
    <div id="faq-modal" class="modal-overlay hidden"><div class="modal-content"><button id="close-faq-modal" class="close-overlay-btn">&times;</button><h3 id="faq-modal-title">Pergunta</h3><form id="faq-form"><input type="hidden" id="faq-id"><div class="form-group"><label>Pergunta</label><input type="text" id="faq-question" required></div><div class="form-group"><label>Resposta</label><textarea id="faq-answer" rows="4" required></textarea></div><div class="modal-footer"><button type="button" id="delete-faq-btn" class="submit-btn danger-btn hidden">Excluir</button><div class="right-buttons"><button type="button" id="cancel-faq-btn" class="submit-btn secondary-btn">Cancelar</button><button type="submit" class="submit-btn">Salvar</button></div></div></form></div></div>
<div id="course-modal" class="modal-overlay hidden">
        <div class="modal-content large-modal">
            <div class="modal-header" style="margin-bottom: 15px; flex-shrink: 0;">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h3 id="course-modal-title" style="margin:0;">Gerenciar Curso</h3>
                    <button id="close-course-modal" class="close-overlay-btn" style="position:static;">&times;</button>
                </div>
            </div>

            <form id="course-form" class="scrollable-form">
                <input type="hidden" id="course-id">
                
                <div class="form-group">
                    <label>Título do Curso</label>
                    <input type="text" id="course-title" required placeholder="Ex: Introdução ao Teatro">
                </div>

                <div class="form-group">
                    <label>Descrição</label>
                    <textarea id="course-desc" rows="3" placeholder="Resumo do que será ensinado..."></textarea>
                </div>

                <div class="form-group">
                    <label>Capa do Curso</label>
                    <div style="display: flex; gap: 15px; align-items: flex-start;">
                        <img id="course-cover-preview" src="" style="width: 100px; height: 100px; object-fit: cover; border-radius: 6px; display: none;">
                        
                        <div style="flex: 1;">
                            <input type="file" id="course-cover-upload" accept="image/*" style="display: none;">
                            <input type="hidden" id="course-cover-url"> <label for="course-cover-upload" class="upload-btn small-btn secondary-btn" style="width: 100%; text-align: center; margin-bottom: 5px;">
                                <ion-icon name="cloud-upload-outline"></ion-icon> Escolher Imagem
                            </label>
                            <small id="course-cover-status" style="color: #aaa;">Tamanho recomendado: 800x600</small>
                        </div>
                    </div>
                </div>

                <hr class="form-divider" style="border: 0; border-top: 1px solid #333; margin: 20px 0;">

                <div class="form-group">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
                        <label style="margin:0; color:var(--secondary-color);">Módulos e Aulas</label>
                        <button type="button" id="add-module-btn" class="submit-btn small-btn secondary-btn">
                            <ion-icon name="add"></ion-icon> Módulo
                        </button>
                    </div>
                    <div id="modules-container"></div>
                </div>
            </form>

            <div class="modal-footer" style="margin-top: 0; padding-top: 15px; border-top: 1px solid #333; flex-shrink: 0;">
                <button type="button" id="delete-course-btn" class="submit-btn danger-btn hidden">Excluir</button>
                <div class="right-buttons" style="margin-left: auto; display: flex; gap: 10px;">
                    <button type="button" id="cancel-course-btn" class="submit-btn secondary-btn">Cancelar</button>
                    <button type="submit" form="course-form" class="submit-btn">Salvar Curso</button>
                </div>
            </div>
        </div>
    </div>
    <div id="game-modal" class="modal-overlay hidden" style="z-index: 9999;">
    <div class="modal-content large-modal" style="width: 90%; max-width: 700px; max-height: 90vh; display: flex; flex-direction: column;">
        
        <div class="modal-header" style="flex-shrink: 0;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h3 id="modal-title" style="margin: 0; display: flex; align-items: center; gap: 10px;">
                    <ion-icon name="game-controller-outline"></ion-icon> Gerenciar Jogo
                </h3>
                <button type="button" onclick="document.getElementById('game-modal').classList.add('hidden')" class="close-overlay-btn" style="background:none; border:none; color:#fff; font-size:1.5rem; cursor:pointer;">&times;</button>
            </div>
        </div>

<form id="game-form" class="scrollable-form" style="overflow-y: auto; padding-right: 10px; flex: 1; padding-top: 10px;">
            
            <input type="hidden" id="game-id">

            <div class="form-group">
                <label style="color:#ccc;">Nome do Jogo</label>
                <input type="text" id="game-name" class="input-field" required placeholder="Ex: O Mistério da Mansão" style="width:100%;">
            </div>

            <div style="display: flex; gap: 15px; margin-bottom: 15px;">
                <div style="flex: 1;">
                    <label style="color:#aaa; font-size:0.85rem;">Valor (R$)</label>
                    <input type="text" id="game-price" class="input-field" placeholder="0.00" style="width:100%;">
                </div>
                <div style="flex: 1;">
                    <label style="color:#aaa; font-size:0.85rem;">Max. Jogadores</label>
                    <input type="number" id="game-players" class="input-field" placeholder="Ex: 5" style="width:100%;">
                </div>
                <div style="flex: 1;">
                    <label style="color:#aaa; font-size:0.85rem;">Timer Inicial (min)</label>
                    <input type="number" id="game-timer" class="input-field" placeholder="Ex: 60" style="width:100%;">
                </div>
            </div>

            <div class="form-group">
                <label style="color:#aaa; font-size:0.85rem;">Descrição Curta (Card)</label>
                <input type="text" id="game-short-desc" class="input-field" placeholder="Resumo em uma frase..." maxlength="100" style="width:100%;">
            </div>

            <div class="form-group">
                <label style="color:#aaa; font-size:0.85rem;">Descrição Longa (Detalhes)</label>
                <textarea id="game-long-desc" class="input-field" rows="4" placeholder="História completa e detalhes do jogo..." style="width:100%; resize:vertical;"></textarea>
            </div>

            <hr style="border:0; border-top:1px solid #333; margin: 20px 0;">

            <div class="form-group">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                    <label style="color:var(--primary-color); font-weight:bold;">Mídias da Sessão</label>
                    <label for="asset-upload" class="upload-btn small-btn" style="cursor:pointer;">
                        <ion-icon name="cloud-upload-outline"></ion-icon> Adicionar
                    </label>
                    <input type="file" id="asset-upload" multiple style="display:none" onchange="handleAssetUpload(this)">
                </div>
                <div id="assets-list" style="background:#1a1a1a; padding:10px; border-radius:5px; min-height:50px; border:1px dashed #333;">
                    <p style="text-align:center; color:#555; font-size:0.8rem;">Nenhuma mídia adicionada</p>
                </div>
            </div>

            <div class="form-group">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                    <label style="color:var(--primary-color); font-weight:bold;">Decisões Interativas</label>
                    <button type="button" onclick="addDecision()" class="upload-btn small-btn" style="border:none; cursor:pointer; color:#fff;">
                        <ion-icon name="add-circle-outline"></ion-icon> Nova
                    </button>
                </div>
                <div id="decisions-list" style="background:#1a1a1a; padding:10px; border-radius:5px; min-height:50px; border:1px dashed #333;">
                    <p style="text-align:center; color:#555; font-size:0.8rem;">Nenhuma decisão criada</p>
                </div>
            </div>

            <div class="form-group" style="margin-top: 30px; border-top: 1px solid #333; padding-top: 15px;">
                <div style="display: flex; align-items: center; justify-content: space-between; cursor: pointer; background:#222; padding:10px; border-radius:5px;" onclick="document.getElementById('enable-extra-life').click()">
                    <h4 style="color:var(--primary-color); margin:0; display:flex; align-items:center; gap:10px; font-size:1rem;">
                        <ion-icon name="heart-circle-outline" style="font-size: 1.4rem; color:#ff4444;"></ion-icon> Habilitar Vida Extra
                    </h4>
                    <div class="toggle-switch">
                        <input type="checkbox" id="enable-extra-life" onchange="toggleExtraLifeSection()" onclick="event.stopPropagation()" style="width: 20px; height: 20px; cursor: pointer; accent-color: var(--primary-color);">
                    </div>
                </div>

                <div id="extra-life-options" class="hidden" style="margin-top: 15px; padding-left: 10px; border-left: 2px solid #333;">
                    <div style="display: flex; gap: 15px; margin-bottom: 20px; width: 100%;">
                        <label id="btn-opt-upload" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; background: #222; border: 1px solid #333; padding: 15px; border-radius: 8px;">
                            <input type="radio" name="extraLifeSource" value="upload" checked onchange="toggleExtraLifeSource()" style="margin-bottom: 8px;">
                            <span style="color: #fff; font-weight: bold; font-size:0.9rem;">Novo Vídeo</span>
                        </label>
                        <label id="btn-opt-library" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: not-allowed; background: #222; border: 1px solid #333; padding: 15px; border-radius: 8px; opacity: 0.5;">
                            <input type="radio" id="radio-library" name="extraLifeSource" value="select" onchange="toggleExtraLifeSource()" style="margin-bottom: 8px;" disabled>
                            <span style="color: #fff; font-weight: bold; font-size:0.9rem;">Biblioteca</span>
                            <span id="library-count-label" style="color: #888; font-size: 0.7rem;">(Vazio)</span>
                        </label>
                    </div>
                    <div id="extra-life-upload-container">
                        <label style="font-size: 0.85rem; color: #aaa;">Arquivo de Vídeo (.mp4):</label>
                        <input type="file" id="extra-life-video" accept="video/*" class="file-input" style="width: 100%;">
                    </div>
                    <div id="extra-life-select-container" class="hidden">
                        <label style="font-size: 0.85rem; color: #aaa;">Selecione vídeo deste jogo:</label>
                        <select id="extra-life-history-select" class="input-field" style="width: 100%; padding:8px; background:#222; color:#fff;">
                            <option value="">Carregando...</option>
                        </select>
                        <p id="selected-video-preview" style="font-size: 0.8rem; color: var(--primary-color); margin-top: 5px;"></p>
                    </div>
                    <div style="margin-top: 15px;">
                        <label style="font-size: 0.85rem; color: #aaa;">Duração (minutos):</label>
                        <input type="number" id="extra-life-duration" placeholder="7" value="7" class="input-field" style="width: 100px;">
                    </div>
                </div>
            </div>
        </form>

        <div class="modal-footer" style="padding-top: 15px; border-top: 1px solid #333; margin-top: auto; display:flex; justify-content:space-between; align-items:center;">            
            <div style="display:flex; gap:10px; margin-left:auto;">
                <button type="button" onclick="document.getElementById('game-modal').classList.add('hidden')" class="submit-btn secondary-btn" style="background:transparent; border:1px solid #555; color:#ccc; padding:10px 15px; border-radius:5px; cursor:pointer;">Cancelar</button>
                <button type="submit" form="game-form" class="submit-btn" style="background:var(--primary-color); color:#000; font-weight:bold; border:none; padding:10px 20px; border-radius:5px; cursor:pointer;">Salvar Jogo</button>
            </div>
        </div>
    </div>
</div>

    <div id="agenda-modal" class="modal-overlay hidden">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Agenda: <span id="agenda-game-name" style="color:var(--secondary-color)"></span></h2>
                <button id="close-agenda-modal" class="close-overlay-btn">&times;</button>
            </div>
            <div class="modal-body-scroll">
                <div class="tab-buttons" style="margin-bottom: 1rem;">
                    <button type="button" class="tab-btn active" id="tab-calendar-view">Calendário</button>
                    <button type="button" class="tab-btn" id="tab-bulk-add">Em Massa</button>
                </div>

                <div id="schedule-view-calendar">
                    <div class="game-calendar-container">
                        <div class="calendar-header">
                            <button type="button" id="admin-prev-month" class="nav-btn"><ion-icon name="chevron-back"></ion-icon></button>
                            <h4 id="admin-month-header">Janeiro 2026</h4>
                            <button type="button" id="admin-next-month" class="nav-btn"><ion-icon name="chevron-forward"></ion-icon></button>
                        </div>
                        <div class="calendar-weekdays"><div>Dom</div><div>Seg</div><div>Ter</div><div>Qua</div><div>Qui</div><div>Sex</div><div>Sáb</div></div>
                        <div id="admin-calendar-grid" class="calendar-grid"></div>
                    </div>
                    
                    <div id="single-day-editor" class="hidden">
                        <h4>Horários para <span id="editing-date-display" style="color:var(--secondary-color);"></span></h4>
                        <div id="single-day-slots" style="display:flex;flex-wrap:wrap;gap:0.5rem;margin:10px 0;"></div>
                        <div style="display:flex; gap:10px;">
                        <input type="text" id="single-time-input" placeholder="HH:MM" maxlength="5" style="flex:1; padding:0.5rem; border-radius:5px; background:var(--bg-color); color:#fff; border:1px solid #444; text-align:center; font-size:1.1rem; letter-spacing: 2px;"><button type="button" id="add-single-time-btn" class="submit-btn small-btn">+</button>
                        </div>
                        <div style="display:flex;gap:10px;margin-top:15px;justify-content:flex-end;">
                            <button id="clear-day-btn" class="submit-btn danger-btn small-btn">Limpar Dia</button>
                            <button id="save-single-day-btn" class="submit-btn small-btn">Salvar Dia</button>
                        </div>
                    </div>
                </div>

                <div id="schedule-view-bulk" class="hidden">
                    <div class="form-group"><label>Período</label><div style="display:flex;gap:10px;"><input type="date" id="bulk-start-date"><input type="date" id="bulk-end-date"></div></div>
                    <div class="form-group"><label>Dias</label><div style="display:flex;gap:5px;flex-wrap:wrap;"><label><input type="checkbox" value="0" checked> Dom</label><label><input type="checkbox" value="1" checked> Seg</label><label><input type="checkbox" value="2" checked> Ter</label><label><input type="checkbox" value="3" checked> Qua</label><label><input type="checkbox" value="4" checked> Qui</label><label><input type="checkbox" value="5" checked> Sex</label><label><input type="checkbox" value="6" checked> Sáb</label></div></div>
                    <div class="form-group"><label>Horários</label><div style="display:flex;gap:5px;"><select id="bulk-time-input" style="flex:1;padding:5px;border-radius:5px;background:var(--bg-color);color:#fff;border:1px solid #444;"></select><button type="button" id="add-bulk-time-btn" class="submit-btn small-btn">Add</button></div></div>
                    <div id="bulk-times-list" style="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;min-height:40px;border:1px dashed var(--border-color);padding:5px;"></div>
                    <button type="button" id="apply-bulk-schedule-btn" class="submit-btn primary-btn" style="width:100%">Aplicar Agenda</button>
                </div>
            </div>
        </div>
    </div>

    <div id="delete-confirm-modal" class="modal-overlay hidden" style="z-index: 3000;">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <ion-icon name="warning-outline" style="font-size: 3rem; color: #ff4f4f;"></ion-icon>
            <h3 style="color: #ff4f4f;">Excluir Jogo?</h3>
            <p>Digite o nome do jogo para confirmar:</p>
            <strong id="delete-game-name-display" class="delete-confirmation-highlight"></strong>
            <input type="text" id="delete-verification-input" placeholder="Digite o nome aqui" class="form-group">
            <div class="modal-footer" style="justify-content: center; gap: 10px; padding-top: 0; border: none;">
                <button id="cancel-delete-modal-btn" class="submit-btn secondary-btn">Cancelar</button>
                <button id="confirm-delete-action-btn" class="submit-btn danger-btn" disabled>Excluir</button>
            </div>
        </div>
    </div>

    <div id="game-sessions-modal" class="modal-overlay hidden">
            <div class="modal-content" id="sessions-modal-content">
            <div class="modal-header">
                <h2>Sessões: <span id="sessions-game-name" style="color:var(--secondary-color)"></span></h2>
                <button id="close-sessions-modal" class="close-overlay-btn">&times;</button>
            </div>
            
            <div class="modal-body-scroll">
                <p class="form-hint" style="margin-bottom: 1rem;">Abaixo estão os agendamentos futuros para este jogo.</p>
                
                <div id="game-sessions-list" class="bookings-list">
                    <div class="loader"></div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button id="close-sessions-btn" class="submit-btn secondary-btn" style="width: 100%;">Fechar</button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <script src="assets/js/firebase-config.js"></script>
    <script>
        loadAsset('assets/css/style.79ce2603.css');
        loadAsset('assets/js/admin.79ce2603.js');
    </script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
</body>
</html>